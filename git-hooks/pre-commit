#!/bin/sh

echo "ğŸ” Executando Gitleaks para detectar secrets..."

# Roda gitleaks em arquivos staged 
# --staged: apenas arquivos staged
# --verbose: mostra detalhes do log
# --redact: redige os arquivos com os secrets detectados

gitleaks protect --staged --verbose --redact

if [ $? -eq 1 ]; then
    echo ""
    echo "âŒ COMMIT BLOQUEADO: Secrets detectados!"
    echo ""
    echo "ğŸ’¡ Remova as credenciais sensÃ­veis antes de commitar."
    echo "   Ou adicione false positives ao .gitleaks.toml"
    exit 1
fi

echo "âœ… Nenhum secret detectado. Commit permitido."
exit 0
